HTTP のようなリクエスト/レスポンス型のプロトコルを、WebSocket で実装し、クライアント間で通信できるようにすることを考える。  
WebSocket サーバとしては ex08/server.js が用意されており、以下のコマンドで実行すると ws://localhost:3003 で WebSocket サーバが起動する。

> node ex08/server.js

この WebSocket サーバはクライアントから受信したメッセージ文字列を、他のクライアントに対して転送するようになっている。  
ただし、メッセージ転送時にランダムに 0-5 秒の遅延が発生するようになっている。  
以下の手順でこのサーバに接続したクライアント間で通信する実装しなさい。

1. WebSocket サーバに文字列データを含むリクエストメッセージを送信する sendRequest 関数を実装しなさい。

- 引数としてリクエスト本文を受け取り、返り値としてレスポンス本文が得られる Promise<string> を返すこと。
- 一定時間内にレスポンスを受信したら、Promise が resolve されること。
- 一定時間経過時にタイムアウトし、Promise が reject されること。
- WebSocket の接続が切断した場合、Promise が reject されること。
- 送信するメッセージの形式は、リクエストが複数並行して送信されてもよいよう考慮すること

例

const response = await sendRequest("World");
console.log(response); // -> "Hello, World"

2. 1.とは別の WebSocket 接続で、WebSocket サーバから転送されたリクエストメッセージを受信してレスポンスを返す実装をしなさい。

- レスポンス本文は、 リクエスト本文の先頭に Hello, を付加したものを返すこと。
- どのリクエストに対するレスポンスか、リクエストした側で判別できるようにすること。

3. 1., 2. を利用してリクエストの送信とレスポンスの確認が可能な Web ページを作成しなさい

- リクエスト本文の入力欄を複数用意し、ボタン押下時に sendRequest 関数でを同時にリクエストを送信するできるようにすること。
- 時間内にレスポンスが返った場合はレスポンス本文を、エラーまたはタイムアウトが発生した場合はその内容を、対応するリクエスト入力欄の横または下に表示すること。

出題範囲: 15.11.3

# 結果

1.server.js のログに下記が出力されているのは確認できた。
